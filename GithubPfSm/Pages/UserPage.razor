@page "/users/{Username}"
@using GithubPfSm.Services;

@inject UserService UserService
@inject GithubService GithubService

@if (userProfile != null)
{
    <AntDesign.Row>
        <AntDesign.Col Span="4">
            <AntDesign.Avatar Src="@userProfile.User.AvatarUrl" Size="128"/>
        </AntDesign.Col>
        <AntDesign.Col Span="20">
            <AntDesign.Descriptions>
                <DescriptionsItem Title="@("Username")">
                    @userProfile.User.Login
                </DescriptionsItem>
                <DescriptionsItem Title="@("Repos")">
                    @userProfile.User.PublicRepos
                </DescriptionsItem>
                <DescriptionsItem Title="@("JoinAt")">
                    @userProfile.User.CreatedAt
                </DescriptionsItem>
                <DescriptionsItem Title="@("Email")">
                    @userProfile.User.Email
                </DescriptionsItem>
                <DescriptionsItem Title="@("Company")">
                    @userProfile.User.Company
                </DescriptionsItem>
                <DescriptionsItem Title="@("Github Link")">
                    @($"https://github.com/{Username}")
                </DescriptionsItem>
            </AntDesign.Descriptions>
            
        </AntDesign.Col>
    </AntDesign.Row>
}
else
{
    <Skeleton />
}

<Line Data="data" Config="config" />

@code {
    [Parameter]
    public string Username { get; set; }

    object[] data = new object[] {
        new { year = "1991", value = 3 },
        new { year = "1992", value = 4 },
        new { year = "1993", value = 3.5 },
        new { year = "1994", value = 5 },
        new { year = "1995", value = 4.9 },
        new { year = "1996", value = 6 },
        new { year = "1997", value = 7 },
        new { year = "1998", value = 9 },
        new { year = "1999", value = 13 },
    };

    LineConfig config = new LineConfig () {
        Title = new AntDesign.Charts.Title () {
        Visible = true,
        Text = "曲线折线图",
        },
        Description = new AntDesign.Charts.Description () {
        Visible = true,
        Text = "用平滑的曲线代替折线。",
        },
        Padding = "auto",
        ForceFit = true,
        XField = "year",
        YField = "value",
        Smooth = true,
    };

    private GithubPfSm.Entities.UserProfile userProfile;
    protected override async Task OnInitializedAsync () {
        userProfile = await UserService.GetUserProfile (Username);
    }
}
